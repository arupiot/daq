# reporting_utils
# Helper functions written in bash for simplifying report writing


# write_out_result
# All inputs are variables (not files)
# Intended to write out output for one test 
# to the .md report

function write_out_result {
    REPORT=$1
    TEST_NAME=$2
    TEST_DESCRIPTION=$3
    LOG=$4
    RESULT_AND_SUMMARY=$5

    cat <<END >> $REPORT
--------------------
$TEST_NAME
--------------------
$TEST_DESCRIPTION
--------------------
$LOG
--------------------
$RESULT_AND_SUMMARY

END
}

# check_for_fails_in
# Input is an array of variables (not files!) containing text
# Intended for use by test running bash scripts to return a non-zero
# exit code if any test in a module fails
# This way, the firebase dashboard shows 'red' if there has been a failure
# in any test

function check_for_fails_in() {
    local arr=("$@")
    local result="false"
    for log in "${arr[@]}";
        do
            if grep -q 'RESULT fail' <<< $log; then
                result="true"
            fi
        done
    echo $result
}